<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to Binary Converter with Console</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.21.2/min/vs/loader.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 50px;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        button {
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .hidden {
            display: none;
        }
        #editor {
            height: 400px;
            border: 1px solid #ccc;
            margin-bottom: 20px;
        }
        #console {
            background-color: #1e1e1e;
            color: #ffffff;
            padding: 10px;
            height: 150px;
            overflow-y: auto;
            font-family: monospace;
            border: 1px solid #ccc;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Text to Binary File Converter with Console</h1>
    <div id="editor"></div>

    <h2>Console</h2>
    <div id="console"></div>

    <!-- Prepare File Button -->
    <button onclick="prepareBinaryFile()">Prepare File</button>

    <div id="fileReady" class="hidden">
        <p>Your file <strong>script.bin</strong> is ready!</p>
        <button id="downloadButton" onclick="downloadBinaryFile()">Download File</button>
    </div>
</div>

<script>
    let editor, blob;

    // Initialize Monaco Editor with default text
    require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.21.2/min/vs' }});
    require(['vs/editor/editor.main'], function () {
        editor = monaco.editor.create(document.getElementById('editor'), {
            value: `REM TITLE Example\nREM AUTHOR DEV\nREM DESCRIPTION Hello World!\nDELAY 3000\nSTRING Hello World!`,
            language: 'plaintext',
            theme: 'vs-dark'
        });
    });

    function logToConsole(message) {
        const consoleElement = document.getElementById('console');
        consoleElement.innerHTML += message + '<br>';
        consoleElement.scrollTop = consoleElement.scrollHeight;  // Auto-scroll to the latest message
    }

    function prepareBinaryFile() {
        // Get the text from the Monaco Editor
        const text = editor.getValue();
        
        // Convert each character to its hexadecimal form (raw binary data)
        const binaryData = new Uint8Array(text.length);
        for (let i = 0; i < text.length; i++) {
            binaryData[i] = text.charCodeAt(i); // Convert each character to raw binary data
        }

        // Optionally, XOR or encrypt the data for non-readable encoding
        for (let i = 0; i < binaryData.length; i++) {
            binaryData[i] = binaryData[i] ^ 0xA3; // XOR with 0xA3 to obscure the text
        }

        // Create a Blob from the binary data
        blob = new Blob([binaryData], { type: "application/octet-stream" });

        // Log to console
        logToConsole("File prepared: script.bin");

        // Show the file ready message
        document.getElementById("fileReady").classList.remove("hidden");
    }

    function downloadBinaryFile() {
        // Create a link to download the file
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "script.bin";  // Name of the binary file

        // Automatically trigger the download
        link.click();

        // Log to console
        logToConsole("File downloaded: script.bin");
    }
</script>

</body>
</html>
